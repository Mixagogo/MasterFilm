<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Мастер-Фільм</title>
  <link href="TVstyle.css" rel="stylesheet">
	<script src="Filmscript.js"></script>
</head>

<header>
  <h1>Мастер-Фільм</h1>
  <h1>Онлайн ТВ</h1> 
  <div class = "menu">
    <ul>
      <a href="index.html">Головна</a>
      <a href="Series.html">Серіали</a>
      <a href="Films.html">Фільми</a>
      <a href="Shows.html">Мультфільми</a>
      <a href="onlineradio.html">Онлайн радіо</a>
      <a href="onlineTV.html">Онлайн ТВ</a>
    </ul>
  </div>  
</header>

<body>
  <div class="wrap">
    <div class="card" role="main">
      <div class="player" aria-label="HLS player">
        <video id="video" controls playsinline crossorigin="anonymous"></video>
      </div>

      <div class="controls">
        <select id="channelSelect">
          <option value="http://50.7.28.226/8180/index.m3u8">Індиго TV</option>
          <option value="http://50.7.28.226/8098/index.m3u8">НЛО TV</option>
          <option value="http://50.7.28.226/8258/index.m3u8">112 Україна</option>
          <option value="http://50.7.28.226/8044/index.m3u8">24 канал</option>
          <option value="http://50.7.28.226/8058/index.m3u8">ATV</option>
          <option value="http://50.7.28.226/8182/index.m3u8">ATR</option>
          <option value="http://50.7.28.226/8166/index.m3u8">BBC World News</option>
          <option value="http://50.7.28.226/8104/index.m3u8">Малятко</option>
          <option value="http://50.7.28.226/8054/index.m3u8">Brava HD</option>
          <option value="http://50.7.28.226/8146/index.m3u8">KVARTAL TV</option>
          <option value="http://50.7.28.226/8046/index.m3u8">BUSINESS</option>
          <option value="http://50.7.28.226/8078/index.m3u8">XSport</option>
          <option value="http://50.7.28.226/8188/index.m3u8">Da Vinci Learning</option>
          <option value="http://50.7.28.226/8168/index.m3u8">Deutsche Welle</option>
          <option value="http://50.7.28.226/8322/index.m3u8">Discovery Channel</option>
          <option value="http://50.7.28.226/8324/index.m3u8">Discovery Science</option>
          <option value="http://50.7.28.226/8326/index.m3u8">DTX</option>
          <option value="http://50.7.28.226/8106/index.m3u8">EWTN</option>
          <option value="http://50.7.28.226/8062/index.m3u8">EU Music HD</option>
          <option value="http://50.7.28.226/8082/index.m3u8">EURO NEWS UA</option>
          <option value="http://50.7.28.226/8160/index.m3u8">Euronews</option>
          <option value="http://50.7.28.226/8314/index.m3u8">Fast&Fun Box</option>
          <option value="http://50.7.28.226/8334/index.m3u8">FOX</option>
          <option value="http://50.7.28.226/8336/index.m3u8">FOX Life</option>
          <option value="http://50.7.28.226/8338/index.m3u8">ID Investigation</option>
          <option value="http://50.7.28.226/8056/index.m3u8">Fashion TV HD</option>
          <option value="http://50.7.28.226/8032/index.m3u8">Гумор</option>
          <option value="http://50.7.28.226/8108/index.m3u8">Hustler TV</option>
          <option value="http://50.7.28.226/8036/index.m3u8">Інтер+</option>
          <option value="http://50.7.28.226/8134/index.m3u8">MAXXI TV</option>
          <option value="http://50.7.28.226/8030/index.m3u8">К1</option>
          <option value="http://50.7.28.226/8034/index.m3u8">К2</option>
          <option value="http://50.7.28.226/8158/index.m3u8">KYIV LIVE</option>
          <option value="http://50.7.28.226/8146/index.m3u8">Квартал ТВ</option>
          <option value="http://50.7.28.226/8066/index.m3u8">Lyric Dance</option>
          <option value="http://50.7.28.226/8184/index.m3u8">Lale</option>
          <option value="http://50.7.28.226/8060/index.m3u8">М1</option>
          <option value="http://50.7.28.226/8064/index.m3u8">М2</option>
          <option value="http://50.7.28.226/8144/index.m3u8">Mix Music HD</option>
          <option value="http://50.7.28.226/8026/index.m3u8">Мега</option>
          <option value="http://50.7.28.226/8104/index.m3u8">Малятко ТВ</option>
          <option value="http://50.7.28.226/8120/index.m3u8">НТА</option>
          <option value="http://50.7.28.226/8122/index.m3u8">Наш</option>
          <option value="http://50.7.28.226/8098/index.m3u8">НЛО TV</option>
          <option value="http://50.7.28.226/8194/index.m3u8">ОЦЕ</option>
          <option value="http://50.7.28.226/8190/index.m3u8">Один</option>
          <option value="http://50.7.28.226/8206/index.m3u8">Перший Діловий</option>
          <option value="http://50.7.28.226/8024/index.m3u8">ПлюсПлюс</option>
          <option value="http://50.7.28.226/8344/index.m3u8">Paramount Comedy</option>
          <option value="http://50.7.28.226/8020/index.m3u8">СТБ</option>
          <option value="http://50.7.28.226/8118/index.m3u8">Sonce</option>
          <option value="http://50.7.28.226/8022/index.m3u8">ТЕТ</option>
          <option value="http://50.7.28.226/8076/index.m3u8">Трофей</option>
          <option value="http://50.7.28.226/8360/index.m3u8">Travel Channel</option>
          <option value="http://50.7.28.226/8084/index.m3u8">UA TV</option>
          <option value="http://50.7.28.226/8096/index.m3u8">Україна 24</option>
          <option value="http://50.7.28.226/8356/index.m3u8">Viasat Explore</option>
          <option value="http://50.7.28.226/8358/index.m3u8">Viasat History</option>
          <option value="http://50.7.28.226/8362/index.m3u8">Viasat Nature</option>
          <option value="http://50.7.28.226/8090/index.m3u8">VH1 European</option>
          <option value="http://50.7.28.226/8372/index.m3u8">VIP Megahit</option>
          <option value="http://50.7.28.226/8370/index.m3u8">VIP Comedy</option>
          <option value="http://50.7.28.226/8368/index.m3u8">VIP Premiere</option>
          <option value="http://50.7.28.226/8142/index.m3u8">ZOOM</option>
          <option value="http://50.7.28.226/8080/index.m3u8">ZIK</option>
          <option value="http://50.7.28.226/8124/index.m3u8">Житомир</option>
          <option value="http://50.7.28.226/8126/index.m3u8">Здоров'я</option>
          <option value="http://50.7.28.226/8042/index.m3u8">5 канал</option>
          <option value="http://50.7.28.226/8018/index.m3u8">1+1</option>
          <option value="http://50.7.28.226/8074/index.m3u8">2+2</option>
          <option value="http://50.7.28.226/8130/index.m3u8">Надія</option>
          <option value="http://50.7.28.226/8050/index.m3u8">Еспресо TV</option>
          <option value="http://50.7.28.226/8088/index.m3u8">Рада</option>
          <option value="http://50.7.28.226/8136/index.m3u8">Чернівці</option>
          <option value="http://50.7.28.226/8138/index.m3u8">Черкаси</option>
          <option value="http://50.7.28.226/8154/index.m3u8">Odesa Live</option>
          <option value="http://50.7.28.226/8152/index.m3u8">Хмельницький 33</option>

        </select>

        <button id="loadBtn" class="btn">Відкрити</button>
        <button id="fullscreenBtn" class="btn secondary">Повний екран</button>
		<button id="loadPlaylistBtn" class="btn secondary">Завантажити плейлист</button>
    <input type="file" id="playlistFile" accept=".m3u,.m3u8,.txt" style="display:none">
        <div class="status" id="status">Готово</div>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
const video = document.getElementById('video');
const channelSelect = document.getElementById('channelSelect');
const loadBtn = document.getElementById('loadBtn');
const fullscreenBtn = document.getElementById('fullscreenBtn');
const status = document.getElementById('status');
let hls = null;

function setStatus(t){ status.textContent=t; }

function unloadStream(){
  if(hls){ try{hls.destroy();}catch{} hls=null; }
  video.pause();
  video.removeAttribute('src');
  video.load();
}

function loadStream(url){
  unloadStream();
  setStatus("Завантаження...");

  if(Hls.isSupported()){
    hls=new Hls();
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED,function(){
      setStatus("Відтворюю");
      video.play().catch(()=>{});
    });
    hls.loadSource(url);
  } else if(video.canPlayType("application/vnd.apple.mpegurl")){
    video.src=url;
    video.onloadmetadata=()=>{ video.play(); };
  } else {
    setStatus("HLS не підтримується цим браузером.");
  }
}

loadBtn.onclick = () => loadStream(channelSelect.value);
window.onload = () => loadStream(channelSelect.value);

fullscreenBtn.onclick = ()=>{
  if(document.fullscreenElement) document.exitFullscreen();
  else document.documentElement.requestFullscreen();
};
const loadPlaylistBtn = document.getElementById('loadPlaylistBtn');
const playlistFile = document.getElementById('playlistFile');

loadPlaylistBtn.onclick = () => playlistFile.click();

playlistFile.addEventListener('change', function() {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        const text = e.target.result;
        parsePlaylist(text);
    };
    reader.readAsText(file);
});

function parsePlaylist(text) {
    let lines = text.split('\n').map(l => l.trim()).filter(l => l);

    let name = "";
    let url = "";

    for (let line of lines) {
        if (line.startsWith("#EXTINF")) {
            // Витягнути ім'я каналу
            let match = line.match(/,(.*)$/);
            name = match ? match[1].trim() : "Канал";
        } else if (line.startsWith("http") || line.startsWith("rtmp") || line.endsWith(".m3u8")) {
            url = line.trim();

            // Додати до випадаючого списку
            const option = document.createElement("option");
            option.value = url;
            option.textContent = name || url;

            channelSelect.appendChild(option);

            name = "";
            url = "";
        }
    }

    setStatus("Плейлист завантажено ✔");
}
</script>
</body>

<footer>
    

</footer>
</html>